<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì°½ì› ì„±ë¯¼ì—¬ìê³ ë“±í•™êµ í¬í„¸</title>
<style>
  body { font-family: Arial; padding: 20px; background: #f9f9f9; }
  h1, h2 { color: #2c3e50; }
  section { margin-bottom: 20px; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);}
  table { border-collapse: collapse; width: 100%; text-align: center; }
  th, td { border: 1px solid #ccc; padding: 8px; }
  .calendar { display: flex; flex-wrap: wrap; width: 280px; margin-bottom: 10px; }
  .day { width: 40px; height: 40px; margin: 2px; display: flex; align-items: center; justify-content: center; cursor: pointer; border-radius: 5px; }
  .event { background-color: #f39c12; color: white; }
  .mood-btn { margin: 3px; cursor: pointer; }
  .mood-display { margin-top: 5px; }
  .bamboo { margin-top: 10px; }
  input[type="text"], input[type="password"] { padding: 5px; margin: 3px; }
</style>
</head>
<body>

<h1>ì°½ì› ì„±ë¯¼ì—¬ìê³ ë“±í•™êµ í¬í„¸</h1>

<section id="login-section">
  <h2>ë¡œê·¸ì¸</h2>
  <input id="login-id" placeholder="ì•„ì´ë””">
  <input id="login-pw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
  <button onclick="login()">ë¡œê·¸ì¸</button>
</section>

<section id="portal-section" style="display:none">
  <button onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>

  <section>
    <h2>ì‹œê°„í‘œ</h2>
    <div id="timetable"></div>
  </section>

  <section>
    <h2>ìº˜ë¦°ë”</h2>
    <div class="calendar" id="calendar"></div>
    <div id="mood-section"></div>
  </section>

  <section>
    <h2>ì…”í‹€ë²„ìŠ¤ ì •ë³´</h2>
    <ul id="bus-list"></ul>
  </section>

  <section>
    <h2>ëŒ€ë‚˜ë¬´ìˆ² ê²Œì‹œíŒ</h2>
    <div class="bamboo">
      <input type="text" id="bamboo-input" placeholder="ìµëª… ê¸€ ì‘ì„±...">
      <button onclick="postBamboo()">ê²Œì‹œ</button>
    </div>
    <ul id="bamboo-list"></ul>
  </section>
</section>

<script>
  // ===== ë¡œê·¸ì¸ & ìœ ì € ë°ì´í„° =====
  const users = [
    {id: 's001', password: '1234', grade: 2, class: 7},
    {id: 's002', password: 'abcd', grade: 2, class: 8}
  ];

  function login() {
    const id = document.getElementById('login-id').value;
    const pw = document.getElementById('login-pw').value;
    const user = users.find(u=>u.id===id && u.password===pw);
    if(user){
      alert(`ë¡œê·¸ì¸ ì„±ê³µ! ${user.grade}í•™ë…„ ${user.class}ë°˜`);
      localStorage.setItem('currentUser', JSON.stringify(user));
      document.getElementById('login-section').style.display='none';
      document.getElementById('portal-section').style.display='block';
      showTimetable(user);
      renderCalendar();
      renderBusInfo();
      showBamboo();
    } else {
      alert('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.');
    }
  }

  function logout(){
    localStorage.removeItem('currentUser');
    location.reload();
  }

  // ===== ì‹œê°„í‘œ ë°ì´í„° (ì˜ˆì‹œ) =====
  const timetables = {
    "2-7":[
      ["êµ­ì–´","ìˆ˜í•™","ì˜ì–´","ê³¼í•™","ì²´ìœ¡"],
      ["êµ­ì–´","ìˆ˜í•™","ì˜ì–´","ê³¼í•™","ì²´ìœ¡"],
      ["ì—­ì‚¬","ìŒì•…","ë¯¸ìˆ ","ì •ë³´","ì˜ì–´"],
      ["ê³¼í•™","ì²´ìœ¡","êµ­ì–´","ìˆ˜í•™","ì˜ì–´"],
      ["ì˜ì–´","ê³¼í•™","ì²´ìœ¡","ì—­ì‚¬","ìŒì•…"]
    ],
    "2-8":[
      ["ìˆ˜í•™","êµ­ì–´","ì˜ì–´","ë¯¸ìˆ ","ì²´ìœ¡"],
      ["ìˆ˜í•™","êµ­ì–´","ì˜ì–´","ìŒì•…","ì²´ìœ¡"],
      ["ì—­ì‚¬","ê³¼í•™","êµ­ì–´","ì˜ì–´","ì²´ìœ¡"],
      ["ê³¼í•™","ì˜ì–´","êµ­ì–´","ì²´ìœ¡","ìŒì•…"],
      ["ì˜ì–´","ì²´ìœ¡","ìˆ˜í•™","ê³¼í•™","ì—­ì‚¬"]
    ]
  };

  function showTimetable(user){
    const key = `${user.grade}-${user.class}`;
    const tableDiv = document.getElementById('timetable');
    const table = document.createElement('table');
    const days = ["ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ"];
    const thead = document.createElement('thead');
    const tr = document.createElement('tr');
    tr.innerHTML="<th>êµì‹œ</th>"+days.map(d=>`<th>${d}</th>`).join("");
    thead.appendChild(tr);
    table.appendChild(thead);

    const tbody = document.createElement('tbody');
    for(let i=0;i<5;i++){
      const tr = document.createElement('tr');
      tr.innerHTML="<td>"+(i+1)+"êµì‹œ</td>"+timetables[key][i].map(c=>`<td>${c}</td>`).join("");
      tbody.appendChild(tr);
    }
    table.appendChild(tbody);
    tableDiv.appendChild(table);
  }

  // ===== ì…”í‹€ë²„ìŠ¤ ì •ë³´ =====
  const buses = [
    {route:"Aì½”ìŠ¤", status:"ìš´í–‰ì¤‘", next:"08:30"},
    {route:"Bì½”ìŠ¤", status:"ì§€ì—°", next:"08:45"}
  ];
  function renderBusInfo(){
    const busList = document.getElementById('bus-list');
    buses.forEach(b=>{
      const li=document.createElement('li');
      li.textContent=`${b.route} - ${b.status} (ë‹¤ìŒ: ${b.next})`;
      busList.appendChild(li);
    });
  }

  // ===== ìº˜ë¦°ë” & ë§ˆìŒì˜¨ë„ =====
  const events = [
    {date:"2025-09-05", title:"ì²´ìœ¡ëŒ€íšŒ"},
    {date:"2025-09-10", title:"ê³¼í•™ì „ì‹œíšŒ"}
  ];
  const moodsData = JSON.parse(localStorage.getItem('moods')||"{}");

  function renderCalendar(){
    const calendar = document.getElementById('calendar');
    calendar.innerHTML="";
    const today = new Date();
    const year = today.getFullYear();
    const month = today.getMonth();
    const firstDay = new Date(year, month,1).getDay(); // ìš”ì¼
    const lastDate = new Date(year, month+1,0).getDate();

    // ë¹ˆì¹¸ ì¶”ê°€
    for(let i=0;i<firstDay;i++){
      const div=document.createElement('div');
      div.className='day'; div.style.visibility='hidden';
      calendar.appendChild(div);
    }

    for(let d=1;d<=lastDate;d++){
      const div=document.createElement('div');
      div.className='day';
      const dateStr = `${year}-${(month+1).toString().padStart(2,'0')}-${d.toString().padStart(2,'0')}`;
      div.textContent=d;

      if(events.some(e=>e.date===dateStr)){
        div.classList.add('event');
        div.onclick=()=>selectMood(dateStr);
      }

      calendar.appendChild(div);
    }
  }

  function selectMood(date){
    const emojis=["ğŸ˜„","ğŸ˜“","ğŸ˜","ğŸ˜¢"];
    const mood = prompt(`ë§ˆìŒì˜¨ë„ ì„ íƒ: ${emojis.join(" ")}`);
    if(!mood) return;
    moodsData[date]=moodsData[date]||[];
    moodsData[date].push(mood);
    localStorage.setItem('moods', JSON.stringify(moodsData));
    showMood(date);
  }

  function showMood(date){
    const section=document.getElementById('mood-section');
    section.innerHTML=`<h3>${date} ë§ˆìŒì˜¨ë„</h3>`;
    const display = document.createElement('div');
    display.className='mood-display';
    display.textContent=moodsData[date].join(" ");
    section.appendChild(display);

    const moreBtn=document.createElement('button');
    moreBtn.textContent="ë”ë³´ê¸°";
    moreBtn.onclick=()=>alert(moodsData[date].join("\n"));
    section.appendChild(moreBtn);
  }

  // ===== ëŒ€ë‚˜ë¬´ìˆ² ê²Œì‹œíŒ =====
  function postBamboo(){
    const input=document.getElementById('bamboo-input');
    const text=input.value.trim();
    if(!text) return;
    const list=JSON.parse(localStorage.getItem('bamboo')||"[]");
    list.push({text,time:new Date().toLocaleString()});
    localStorage.setItem('bamboo',JSON.stringify(list));
    input.value='';
    showBamboo();
  }
  function showBamboo(){
    const list=JSON.parse(localStorage.getItem('bamboo')||"[]");
    const ul=document.getElementById('bamboo-list');
    ul.innerHTML='';
    list.forEach(item=>{
      const li=document.createElement('li');
      li.textContent=`[${item.time}] ${item.text}`;
      ul.appendChild(li);
    });
  }

</script>
</body>
</html>
