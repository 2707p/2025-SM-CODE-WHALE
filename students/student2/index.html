<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì°½ì› ì„±ë¯¼ì—¬ìê³ ë“±í•™êµ í¬í„¸</title>
<style>
body { font-family: Arial; padding: 20px; background: #f9f9f9; }
h1,h2 { color:#2c3e50; }
section { margin-bottom: 20px; background:#fff; padding:15px; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.1);}
table { border-collapse: collapse; width:100%; text-align:center; }
th, td { border:1px solid #ccc; padding:8px; }
.calendar { display:flex; flex-wrap:wrap; width:300px; margin-bottom:10px; }
.day { width:40px; height:40px; margin:2px; display:flex; align-items:center; justify-content:center; cursor:pointer; border-radius:5px; }
.event { background-color:#f39c12; color:white; }
.mood-btn { margin:3px; cursor:pointer; font-size:20px; }
.mood-display { margin-top:5px; }
.bamboo { margin-top:10px; }
input[type="text"], input[type="password"], input[type="number"], textarea { padding:5px; margin:3px; width:200px;}
.pagination { margin-top:10px; }
.pagination button { margin:2px; }
.comment-list { margin-left:20px; font-size:14px; }
button { cursor:pointer; }
</style>
</head>
<body>

<h1>ì°½ì› ì„±ë¯¼ì—¬ìê³ ë“±í•™êµ í¬í„¸</h1>

<section id="login-section">
  <h2>ë¡œê·¸ì¸</h2>
  <input id="login-id" placeholder="ì•„ì´ë””">
  <input id="login-pw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
  <button id="login-btn">ë¡œê·¸ì¸</button>
  <p>ê³„ì •ì´ ì—†ë‚˜ìš”? <button id="show-signup-btn">íšŒì›ê°€ì…</button></p>
</section>

<section id="signup-section" style="display:none">
  <h2>íšŒì›ê°€ì…</h2>
  <input id="signup-id" placeholder="ì•„ì´ë””">
  <input id="signup-pw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
  <input id="signup-grade" type="number" placeholder="í•™ë…„(1~3)">
  <input id="signup-class" type="number" placeholder="ë°˜(1~8)">
  <button id="signup-btn">ê°€ì…í•˜ê¸°</button>
  <button id="hide-signup-btn">ì·¨ì†Œ</button>
</section>

<section id="portal-section" style="display:none">
  <button id="logout-btn">ë¡œê·¸ì•„ì›ƒ</button>

  <section>
    <h2>ì‹œê°„í‘œ</h2>
    <div id="timetable"></div>
  </section>

  <section>
    <h2>ìº˜ë¦°ë”</h2>
    <div>
      <button id="prev-month-btn">â—€ ì´ì „</button>
      <span id="calendar-month"></span>
      <button id="next-month-btn">ë‹¤ìŒ â–¶</button>
    </div>
    <div class="calendar" id="calendar"></div>
    <div id="mood-section"></div>
  </section>

  <section>
    <h2>ì…”í‹€ë²„ìŠ¤ ì •ë³´</h2>
    <ul id="bus-list"></ul>
  </section>

  <section>
    <h2>ëŒ€ë‚˜ë¬´ìˆ² ê²Œì‹œíŒ</h2>
    <div class="bamboo">
      <input type="text" id="bamboo-input" placeholder="ìµëª… ê¸€ ì‘ì„±...">
      <button id="post-bamboo-btn">ê²Œì‹œ</button>
      <button id="show-bamboo-detail-btn">ìì„¸íˆ ë³´ê¸°</button>
    </div>
    <ul id="bamboo-list"></ul>
  </section>
</section>

<section id="bamboo-detail" style="display:none">
  <h2>ëŒ€ë‚˜ë¬´ìˆ² ìƒì„¸ë³´ê¸°</h2>
  <div>
    <input type="text" id="bamboo-detail-input" placeholder="ìµëª… ê¸€ ì‘ì„±...">
    <button id="post-bamboo-detail-btn">ê²Œì‹œ</button>
    <button id="hide-bamboo-detail-btn">ë‹«ê¸°</button>
  </div>
  <ul id="bamboo-detail-list"></ul>
  <div class="pagination" id="bamboo-pagination"></div>
</section>

<script>
// ===================== ì´ˆê¸°í™” =====================
let users = JSON.parse(localStorage.getItem('users')||"[]");
let moodsData = JSON.parse(localStorage.getItem('moods')||"{}");
let currentUser = null;
let bambooPosts = JSON.parse(localStorage.getItem('bamboo')||"[]");
let currentMonth = new Date();
let events=[{date:"2025-09-05",title:"ì²´ìœ¡ëŒ€íšŒ"},{date:"2025-09-10",title:"ê³¼í•™ì „ì‹œíšŒ"}];
const buses=[{route:"Aì½”ìŠ¤",status:"ìš´í–‰ì¤‘",next:"08:30"},{route:"Bì½”ìŠ¤",status:"ì§€ì—°",next:"08:45"}];

// ===================== ë²„íŠ¼ ì´ë²¤íŠ¸ =====================
document.addEventListener('DOMContentLoaded', ()=>{
  document.getElementById('login-btn').addEventListener('click', login);
  document.getElementById('logout-btn').addEventListener('click', logout);
  document.getElementById('show-signup-btn').addEventListener('click', ()=>{ document.getElementById('login-section').style.display='none'; document.getElementById('signup-section').style.display='block'; });
  document.getElementById('hide-signup-btn').addEventListener('click', ()=>{ document.getElementById('signup-section').style.display='none'; document.getElementById('login-section').style.display='block'; });
  document.getElementById('signup-btn').addEventListener('click', signup);
  document.getElementById('prev-month-btn').addEventListener('click', ()=>{ changeMonth(-1); });
  document.getElementById('next-month-btn').addEventListener('click', ()=>{ changeMonth(1); });
  document.getElementById('post-bamboo-btn').addEventListener('click', postBamboo);
  document.getElementById('show-bamboo-detail-btn').addEventListener('click', showBambooDetail);
  document.getElementById('hide-bamboo-detail-btn').addEventListener('click', hideBambooDetail);
  document.getElementById('post-bamboo-detail-btn').addEventListener('click', postBambooDetail);
  showBamboo();
});

// ===================== ë¡œê·¸ì¸/íšŒì›ê°€ì… =====================
function login(){
  const id=document.getElementById('login-id').value;
  const pw=document.getElementById('login-pw').value;
  const user=users.find(u=>u.id===id && u.password===pw);
  if(user){
    alert(`ë¡œê·¸ì¸ ì„±ê³µ! ${user.grade}í•™ë…„ ${user.class}ë°˜`);
    currentUser=user;
    document.getElementById('login-section').style.display='none';
    document.getElementById('portal-section').style.display='block';
    showTimetable(user); renderCalendar(); renderBusInfo(); showBamboo();
  } else alert('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.');
}
function logout(){ currentUser=null; location.reload(); }
function signup(){
  const id=document.getElementById('signup-id').value.trim();
  const pw=document.getElementById('signup-pw').value.trim();
  const grade=parseInt(document.getElementById('signup-grade').value);
  const cls=parseInt(document.getElementById('signup-class').value);
  if(!id||!pw||!grade||!cls){ alert("ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"); return;}
  if(users.some(u=>u.id===id)){ alert("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤."); return;}
  users.push({id:id,password:pw,grade:grade,class:cls});
  localStorage.setItem('users', JSON.stringify(users));
  alert("íšŒì›ê°€ì… ì™„ë£Œ! ë¡œê·¸ì¸ í•´ì£¼ì„¸ìš”.");
  document.getElementById('signup-section').style.display='none';
  document.getElementById('login-section').style.display='block';
}

// ===================== ì‹œê°„í‘œ =====================
const timetables={};
for(let g=1;g<=3;g++){ for(let c=1;c<=8;c++){ timetables[`${g}-${c}`]=[["êµ­ì–´","ìˆ˜í•™","ì˜ì–´","ê³¼í•™","ì²´ìœ¡"],["ì˜ì–´","ì—­ì‚¬","ìˆ˜í•™","ìŒì•…","ì²´ìœ¡"],["ê³¼í•™","êµ­ì–´","ë¯¸ìˆ ","ì²´ìœ¡","ì˜ì–´"],["ìˆ˜í•™","ê³¼í•™","ì²´ìœ¡","ì˜ì–´","ìŒì•…"],["ì²´ìœ¡","ì˜ì–´","ì—­ì‚¬","ë¯¸ìˆ ","ê³¼í•™"]]; } }
function showTimetable(user){
  const key = `${user.grade}-${user.class}`;
  const tableDiv = document.getElementById('timetable'); tableDiv.innerHTML="";
  const table = document.createElement('table'); const days = ["ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ"];
  const thead = document.createElement('thead'); const tr = document.createElement('tr');
  tr.innerHTML="<th>êµì‹œ</th>"+days.map(d=>`<th>${d}</th>`).join(""); thead.appendChild(tr); table.appendChild(thead);
  const tbody=document.createElement('tbody');
  for(let i=0;i<5;i++){
    const tr=document.createElement('tr'); tr.innerHTML="<td>"+(i+1)+"êµì‹œ</td>"+timetables[key][i].map(c=>`<td>${c}</td>`).join(""); tbody.appendChild(tr);
  }
  table.appendChild(tbody); tableDiv.appendChild(table);
}

// ===================== ì…”í‹€ë²„ìŠ¤ =====================
function renderBusInfo(){ const busList=document.getElementById('bus-list'); busList.innerHTML=""; buses.forEach(b=>{ const li=document.createElement('li'); li.textContent=`${b.route} - ${b.status} (ë‹¤ìŒ: ${b.next})`; busList.appendChild(li); }); }

// ===================== ìº˜ë¦°ë” + ë§ˆìŒì˜¨ë„ =====================
function renderCalendar(){
  const calendar=document.getElementById('calendar'); calendar.innerHTML="";
  const year=currentMonth.getFullYear(); const month=currentMonth.getMonth();
  document.getElementById('calendar-month').textContent=`${year}ë…„ ${month+1}ì›”`;
  const firstDay=new Date(year,month,1).getDay();
  const lastDate=new Date(year,month+1,0).getDate();
  for(let i=0;i<firstDay;i++){ const div=document.createElement('div'); div.className='day'; div.style.visibility='hidden'; calendar.appendChild(div);}
  for(let d=1;d<=lastDate;d++){
    const div=document.createElement('div'); div.className='day';
    const dateStr=`${year}-${(month+1).toString().padStart(2,'0')}-${d.toString().padStart(2,'0')}`;
    div.textContent=d;
    if(events.some(e=>e.date===dateStr)){ div.classList.add('event'); div.onclick=()=>selectMood(dateStr);}
    calendar.appendChild(div);
  }
}
function changeMonth(dir){ currentMonth.setMonth(currentMonth.getMonth()+dir); renderCalendar(); }
function selectMood(date){
  const emojis=["ğŸ˜„","ğŸ˜“","ğŸ˜","ğŸ˜¢"]; const section=document.getElementById('mood-section'); section.innerHTML=`<h3>${date} ë§ˆìŒì˜¨ë„</h3>`;
  emojis.forEach(e=>{ const btn=document.createElement('button'); btn.textContent=e; btn.className='mood-btn'; btn.onclick=()=>{ moodsData[date]=moodsData[date]||[]; moodsData[date].push(e); localStorage.setItem('moods',JSON.stringify(moodsData)); showMood(date);}; section.appendChild(btn); });
  showMood(date);
}
function showMood(date){
  const section=document.getElementById('mood-section'); const div=document.createElement('div'); div.className='mood-display';
  const count = moodsData[date] ? moodsData[date].length : 0;
  div.textContent=`ì´ ${count}ëª… ì°¸ì—¬`; section.appendChild(div);
  if(count>0){ const moreBtn=document.createElement('button'); moreBtn.textContent="ë”ë³´ê¸°"; moreBtn.onclick=()=>alert(moodsData[date].join(" ")); section.appendChild(moreBtn);}
}

// ===================== ëŒ€ë‚˜ë¬´ìˆ² =====================
function postBamboo(){ const input=document.getElementById('bamboo-input'); const text=input.value.trim(); if(!text) return; bambooPosts.push({text,time:new Date().toLocaleString(),comments:[],likes:0,dislikes:0}); localStorage.setItem('bamboo',JSON.stringify(bambooPosts)); input.value=''; showBamboo(); }
function showBamboo(){ const list=document.getElementById('bamboo-list'); list.innerHTML=""; bambooPosts.forEach(p=>{ const li=document.createElement('li'); li.textContent=`[${p.time}] ${p.text}`; list.appendChild(li); }); }

// ===================== ëŒ€ë‚˜ë¬´ìˆ² ìƒì„¸ =====================
let itemsPerPage=5, currentPage=1;
function showBambooDetail(){ document.getElementById('portal-section').style.display='none'; document.getElementById('bamboo-detail').style.display='block'; currentPage=1; renderBambooDetail(); }
function hideBambooDetail(){ document.getElementById('bamboo-detail').style.display='none'; document.getElementById('portal-section').style.display='block'; }
function postBambooDetail(){ const input=document.getElementById('bamboo-detail-input'); const text=input.value.trim(); if(!text) return; bambooPosts.push({text,time:new Date().toLocaleString(),comments:[],likes:0,dislikes:0}); localStorage.setItem('bamboo',JSON.stringify(bambooPosts)); input.value=''; renderBambooDetail(); }
function renderBambooDetail(){
  const list=document.getElementById('bamboo-detail-list'); list.innerHTML=""; const start=(currentPage-1)*itemsPerPage; const end=start+itemsPerPage; const pageItems=bambooPosts.slice(start,end);
  pageItems.forEach((p,i)=>{
    const li=document.createElement('li');
    li.innerHTML=`<strong>${p.text}</strong> [${p.time}] <br>ì¶”ì²œ: ${p.likes} ë¹„ì¶”ì²œ: ${p.dislikes}<br>`;
    const likeBtn=document.createElement('button'); likeBtn.textContent="ğŸ‘"; likeBtn.onclick=()=>{p.likes++; localStorage.setItem('bamboo',JSON.stringify(bambooPosts)); renderBambooDetail();};
    const dislikeBtn=document.createElement('button'); dislikeBtn.textContent="ğŸ‘"; dislikeBtn.onclick=()=>{p.dislikes++; localStorage.setItem('bamboo',JSON.stringify(bambooPosts)); renderBambooDetail();};
    li.appendChild(likeBtn); li.appendChild(dislikeBtn);
    const commentInput=document.createElement('input'); commentInput.placeholder="ëŒ“ê¸€ ì‘ì„±"; 
    const commentBtn=document.createElement('button'); commentBtn.textContent="ëŒ“ê¸€"; commentBtn.onclick=()=>{ if(commentInput.value.trim()){p.comments.push(commentInput.value); localStorage.setItem('bamboo',JSON.stringify(bambooPosts)); renderBambooDetail(); } };
    li.appendChild(commentInput); li.appendChild(commentBtn);
    if(p.comments.length>0){ const cdiv=document.createElement('div'); cdiv.className='comment-list'; cdiv.textContent=p.comments.join(", "); li.appendChild(cdiv);}
    list.appendChild(li);
  });
  const totalPages=Math.ceil(bambooPosts.length/itemsPerPage);
  const pagination=document.getElementById('bamboo-pagination'); pagination.innerHTML="";
  for(let i=1;i<=totalPages;i++){ const btn=document.createElement('button'); btn.textContent=i; btn.onclick=(()=>{ currentPage=i; renderBambooDetail(); }); pagination.appendChild(btn);}
}
</script>
</body>
</html>
