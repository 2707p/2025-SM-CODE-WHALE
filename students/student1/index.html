<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì°½ì› ì„±ë¯¼ì—¬ìê³ ë“±í•™êµ í¬í„¸</title>
<style>
body { font-family: Arial; padding: 0; margin:0; background:#f9f9f9; }
header { display:flex; justify-content:space-between; align-items:center; padding:10px 20px; background:#2c3e50; color:white; }
header h1 { margin:0; font-size:20px; }
main { padding:20px; transition: margin-left 0.3s; }
section { margin-bottom: 20px; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);}
button { cursor:pointer; }
input { padding:5px; margin:3px; }
table { border-collapse: collapse; width: 100%; text-align:center;}
th, td { border:1px solid #ccc; padding:8px;}
.calendar { display:flex; flex-wrap:wrap; width:300px; margin-bottom:10px;}
.day { width:40px; height:40px; margin:2px; display:flex; align-items:center; justify-content:center; cursor:pointer; border-radius:5px;}
.event { background-color:#f39c12; color:white;}
.mood-btn { margin:3px; cursor:pointer; font-size:20px;}
.mood-display { margin-top:5px;}
.bamboo { margin-top:10px;}
#sidebar { position:fixed; top:0; left:-25%; width:25%; height:100%; background:#ecf0f1; box-shadow:2px 0 5px rgba(0,0,0,0.2); padding:10px; transition:left 0.3s; overflow-y:auto;}
#sidebar img { width:50px; height:50px; border-radius:50%; display:block; margin:auto; }
#sidebar ul { list-style:none; padding:0; }
#sidebar ul li { padding:10px; cursor:pointer; margin:5px 0; background:#bdc3c7; border-radius:5px;}
#sidebar ul li:hover { background:#95a5a6;}
#main { transition: margin-left 0.3s; }
.profile-section img { width:80px; height:80px; border-radius:50%; }
.profile-section input[type=text]{ width:100%; padding:5px; margin:5px 0;}
</style>
</head>
<body>

<header>
  <h1>ì„±ë¯¼ì—¬ìê³ ë“±í•™êµ í¬í„¸</h1>
  <button onclick="toggleSidebar()">â˜° ë”ë³´ê¸°</button>
</header>

<div id="sidebar">
  <img src="https://via.placeholder.com/50" id="sidebar-profile-img" onclick="showProfile()">
  <ul>
    <li onclick="showNotice()">ê³µì§€</li>
    <li onclick="showCalendarPage()">ìº˜ë¦°ë”</li>
    <li onclick="showTimetablePage()">ì‹œê°„í‘œ</li>
    <li onclick="showBamboo()">ëŒ€ë‚˜ë¬´ìˆ²</li>
    <li onclick="showBus()">ì…”í‹€ë²„ìŠ¤</li>
  </ul>
</div>

<main id="main">
  <!-- ë¡œê·¸ì¸ -->
  <section id="login-section">
    <h2>ë¡œê·¸ì¸</h2>
    <input id="login-id" placeholder="ì•„ì´ë””">
    <input id="login-pw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
    <button onclick="login()">ë¡œê·¸ì¸</button>
    <p>ê³„ì •ì´ ì—†ë‚˜ìš”? <button onclick="showSignup()">íšŒì›ê°€ì…</button></p>
  </section>

  <!-- íšŒì›ê°€ì… -->
  <section id="signup-section" style="display:none">
    <h2>íšŒì›ê°€ì…</h2>
    <input id="signup-id" placeholder="ì•„ì´ë””">
    <input id="signup-pw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
    <input id="signup-grade" type="number" placeholder="í•™ë…„">
    <input id="signup-class" type="number" placeholder="ë°˜">
    <button onclick="signup()">ê°€ì…í•˜ê¸°</button>
    <button onclick="hideSignup()">ì·¨ì†Œ</button>
  </section>

  <!-- í¬í„¸ -->
  <section id="portal-section" style="display:none">
    <button onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>

    <section id="timetable-section">
      <h2>ì‹œê°„í‘œ</h2>
      <div id="timetable"></div>
    </section>

    <section id="calendar-section">
      <h2>ìº˜ë¦°ë”</h2>
      <div>
        <button onclick="changeMonth(-1)">â—€ ì´ì „</button>
        <span id="calendar-month"></span>
        <button onclick="changeMonth(1)">ë‹¤ìŒ â–¶</button>
      </div>
      <div class="calendar" id="calendar"></div>
      <div id="mood-section"></div>
    </section>

    <section id="bus-section">
      <h2>ì…”í‹€ë²„ìŠ¤ ì •ë³´</h2>
      <ul id="bus-list"></ul>
    </section>

    <section id="bamboo-section">
      <h2>ëŒ€ë‚˜ë¬´ìˆ² ê²Œì‹œíŒ</h2>
      <button onclick="showBambooDetail()">ìì„¸íˆ ë³´ê¸°</button>
      <ul id="bamboo-list"></ul>
    </section>
  </section>

  <!-- ê°œì¸ í˜ì´ì§€ -->
  <section id="profile-section" style="display:none">
    <h2>ê°œì¸ í˜ì´ì§€</h2>
    <div class="profile-section">
      <img src="https://via.placeholder.com/80" id="profile-img">
      <p>ì´ë¦„: <span id="profile-name"></span></p>
      <p>í•™ë…„/ë°˜: <span id="profile-gradeclass"></span></p>
      <p>ì•„ì´ë””: <span id="profile-id"></span></p>
      <p>ì§„ë¡œ: <input type="text" id="profile-career"></p>
      <button onclick="backToPortal()">ëŒì•„ê°€ê¸°</button>
    </div>
  </section>

  <!-- ëŒ€ë‚˜ë¬´ìˆ² ìƒì„¸ -->
  <section id="bamboo-detail" style="display:none">
    <h2>ëŒ€ë‚˜ë¬´ìˆ² ìƒì„¸ë³´ê¸°</h2>
    <button onclick="backToPortalFromBamboo()">ë‹«ê¸°</button>
    <div>
      <input type="text" id="bamboo-detail-input" placeholder="ìµëª… ê¸€ ì‘ì„±...">
      <button onclick="postBambooDetail()">ê²Œì‹œ</button>
    </div>
    <ul id="bamboo-detail-list"></ul>
    <div class="pagination" id="bamboo-pagination"></div>
  </section>

</main>

<script>
let sidebarOpen=false;
function toggleSidebar(){
  const sb=document.getElementById('sidebar');
  const main=document.getElementById('main');
  sidebarOpen=!sidebarOpen;
  if(sidebarOpen){ sb.style.left='0'; main.style.marginLeft='25%'; }
  else { sb.style.left='-25%'; main.style.marginLeft='0'; }
}

// ===== ìœ ì € ë°ì´í„° =====
let users=JSON.parse(localStorage.getItem('users')||"[]");

function login(){
  const id=document.getElementById('login-id').value.trim();
  const pw=document.getElementById('login-pw').value.trim();
  const user=users.find(u=>u.id===id && u.password===pw);
  if(user){
    localStorage.setItem('currentUser', JSON.stringify(user));
    document.getElementById('login-section').style.display='none';
    document.getElementById('signup-section').style.display='none';
    document.getElementById('portal-section').style.display='block';
    showTimetable(user);
    renderCalendar();
    renderBus();
    showBamboo();
  }else alert('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.');
}

function logout(){ localStorage.removeItem('currentUser'); location.reload(); }

function showSignup(){ document.getElementById('login-section').style.display='none'; document.getElementById('signup-section').style.display='block'; }
function hideSignup(){ document.getElementById('signup-section').style.display='none'; document.getElementById('login-section').style.display='block'; }

function signup(){
  const id=document.getElementById('signup-id').value.trim();
  const pw=document.getElementById('signup-pw').value.trim();
  const grade=parseInt(document.getElementById('signup-grade').value);
  const cls=parseInt(document.getElementById('signup-class').value);
  if(!id||!pw||!grade||!cls){ alert("ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"); return; }
  if(users.some(u=>u.id===id)){ alert("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤."); return; }
  const newUser={id:id,password:pw,grade:grade,class:cls,name:"í•™ìƒ"+id};
  users.push(newUser); localStorage.setItem('users',JSON.stringify(users));
  alert("íšŒì›ê°€ì… ì™„ë£Œ! ë¡œê·¸ì¸ í•´ì£¼ì„¸ìš”.");
  hideSignup();
}

// ===== ì‹œê°„í‘œ =====
const timetables={};
for(let g=1;g<=3;g++){
  for(let c=1;c<=8;c++){
    timetables[`${g}-${c}`]=[["êµ­ì–´","ìˆ˜í•™","ì˜ì–´","ê³¼í•™","ì²´ìœ¡"],["êµ­ì–´","ìˆ˜í•™","ì˜ì–´","ê³¼í•™","ì²´ìœ¡"],["ì—­ì‚¬","ìŒì•…","ë¯¸ìˆ ","ì •ë³´","ì˜ì–´"],["ê³¼í•™","ì²´ìœ¡","êµ­ì–´","ìˆ˜í•™","ì˜ì–´"],["ì˜ì–´","ê³¼í•™","ì²´ìœ¡","ì—­ì‚¬","ìŒì•…"]];
  }
}

function showTimetable(user){
  const key=`${user.grade}-${user.class}`;
  const tableDiv=document.getElementById('timetable');
  tableDiv.innerHTML="";
  const table=document.createElement('table');
  const days=["ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ"];
  const thead=document.createElement('thead');
  const tr=document.createElement('tr');
  tr.innerHTML="<th>êµì‹œ</th>"+days.map(d=>`<th>${d}</th>`).join("");
  thead.appendChild(tr); table.appendChild(thead);
  const tbody=document.createElement('tbody');
  for(let i=0;i<5;i++){
    const tr=document.createElement('tr');
    tr.innerHTML="<td>"+(i+1)+"êµì‹œ</td>"+timetables[key][i].map(c=>`<td>${c}</td>`).join("");
    tbody.appendChild(tr);
  }
  table.appendChild(tbody); tableDiv.appendChild(table);
}

// ===== ì…”í‹€ë²„ìŠ¤ =====
const buses=[{route:"Aì½”ìŠ¤",status:"ìš´í–‰ì¤‘",next:"08:30"},{route:"Bì½”ìŠ¤",status:"ì§€ì—°",next:"08:45"}];
function renderBus(){
  const ul=document.getElementById('bus-list'); ul.innerHTML="";
  buses.forEach(b=>{
    const li=document.createElement('li');
    li.textContent=`${b.route} - ${b.status} (ë‹¤ìŒ: ${b.next})`;
    ul.appendChild(li);
  });
}

// ===== ìº˜ë¦°ë” + ë§ˆìŒì˜¨ë„ =====
let currentMonth=new Date();
const events=[{date:"2025-09-05",title:"ì²´ìœ¡ëŒ€íšŒ"},{date:"2025-09-10",title:"ê³¼í•™ì „ì‹œíšŒ"}];
let moodsData=JSON.parse(localStorage.getItem('moods')||"{}");

function renderCalendar(){
  const calendar=document.getElementById('calendar'); calendar.innerHTML="";
  const year=currentMonth.getFullYear();
  const month=currentMonth.getMonth();
  document.getElementById('calendar-month').textContent=`${year}ë…„ ${month+1}ì›”`;
  const firstDay=new Date(year,month,1).getDay();
  const lastDate=new Date(year,month+1,0).getDate();
  for(let i=0;i<firstDay;i++){ const div=document.createElement('div'); div.className='day'; div.style.visibility='hidden'; calendar.appendChild(div); }
  for(let d=1;d<=lastDate;d++){
    const div=document.createElement('div'); div.className='day';
    const dateStr=`${year}-${(month+1).toString().padStart(2,'0')}-${d.toString().padStart(2,'0')}`;
    div.textContent=d;
    if(events.some(e=>e.date===dateStr)){ div.classList.add('event'); div.onclick=()=>selectMood(dateStr);}
    calendar.appendChild(div);
  }
}

function changeMonth(dir){ currentMonth.setMonth(currentMonth.getMonth()+dir); renderCalendar(); }

function selectMood(date){
  const emojis=["ğŸ˜„","ğŸ˜“","ğŸ˜","ğŸ˜¢"];
  const section=document.getElementById('mood-section'); section.innerHTML=`<h3>${date} ë§ˆìŒì˜¨ë„</h3>`;
  emojis.forEach(e=>{
    const btn=document.createElement('button'); btn.textContent=e; btn.className='mood-btn';
    btn.onclick=()=>{ moodsData[date]=moodsData[date]||[]; moodsData[date].push(e); localStorage.setItem('moods',JSON.stringify(moodsData)); showMood(date); };
    section.appendChild(btn);
  });
  showMood(date);
}

function showMood(date){
  const section=document.getElementById('mood-section');
  const div=document.createElement('div'); div.className='mood-display';
  div.textContent=`ì´ ${moodsData[date]?.length||0}ëª… ì°¸ì—¬`;
  section.appendChild(div);
  const moreBtn=document.createElement('button'); moreBtn.textContent="ë”ë³´ê¸°"; moreBtn.onclick=()=>alert(moodsData[date].join("\n"));
  section.appendChild(moreBtn);
}

// ===== ëŒ€ë‚˜ë¬´ìˆ² =====
function showBambooDetail(){ alert("ëŒ€ë‚˜ë¬´ìˆ² ìƒì„¸ë³´ê¸° í˜ì´ì§€ ì—´ê¸°"); }
function showBamboo(){ alert("ëŒ€ë‚˜ë¬´ìˆ² ëª©ë¡ ë³´ê¸°"); }
function showNotice(){ alert("ê³µì§€ í˜ì´ì§€ ì—´ê¸°"); }
function showCalendarPage(){ alert("ìº˜ë¦°ë” í˜ì´ì§€ ì—´ê¸°"); }
function showTimetablePage(){ alert("ì‹œê°„í‘œ í˜ì´ì§€ ì—´ê¸°"); }
function showBus(){ alert("ì…”í‹€ë²„ìŠ¤ í˜ì´ì§€ ì—´ê¸°"); }

// ===== ê°œì¸í˜ì´ì§€ =====
function showProfile(){
  const user=JSON.parse(localStorage.getItem('currentUser'));
  if(!user) return;
  document.getElementById('portal-section').style.display='none';
  document.getElementById('profile-section').style.display='block';
  document.getElementById('profile-name').textContent=user.name||user.id;
  document.getElementById('profile-gradeclass').textContent=`${user.grade}í•™ë…„ ${user.class}ë°˜`;
  document.getElementById('profile-id').textContent=user.id;
}
function backToPortal(){ document.getElementById('profile-section').style.display='none'; document.getElementById('portal-section').style.display='block'; }
function backToPortalFromBamboo(){ document.getElementById('bamboo-detail').style.display='none'; document.getElementById('portal-section').style.display='block'; }

</script>
</body>
</html>
